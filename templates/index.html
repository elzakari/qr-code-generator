{% extends "base.html" %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card shadow-sm">
      <div class="card-body">
        <h1 class="h4 mb-3">Generate a Custom QR Code</h1>
        <form method="post" action="{{ url_for('qr.generate') }}" enctype="multipart/form-data" novalidate>
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
          <div class="mb-3">
            <label for="content" class="form-label">Text or URL</label>
            <textarea id="content" name="content" class="form-control" rows="3" required
              placeholder="https://example.com or any text" aria-describedby="contentHelp"></textarea>
            <div id="contentHelp" class="form-text">We never fetch remote URLsâ€”content is embedded only.</div>
          </div>

          <div class="row g-3">
            <div class="col-md-4">
              <label for="size_px" class="form-label">Size (px)</label>
              <input type="number" class="form-control" id="size_px" name="size_px" value="512" min="128" max="4096" aria-describedby="sizeHelp">
              <div id="sizeHelp" class="form-text">Final PNG width/height.</div>
            </div>
            <div class="col-md-4">
              <label for="box_size" class="form-label">Box Size</label>
              <input type="number" class="form-control" id="box_size" name="box_size" value="10" min="1" max="50" aria-describedby="boxHelp">
              <div id="boxHelp" class="form-text">Pixel size of each module (pre-resize).</div>
            </div>
            <div class="col-md-4">
              <label for="margin" class="form-label">Margin (modules)</label>
              <input type="number" class="form-control" id="margin" name="margin" value="4" min="0" max="32" aria-describedby="marginHelp">
              <div id="marginHelp" class="form-text">Quiet zone around the QR.</div>
            </div>
          </div>

          <div class="row g-3 mt-1">
            <div class="col-md-4">
              <label for="error_correction" class="form-label">Error Correction</label>
              <select id="error_correction" name="error_correction" class="form-select">
                <option value="L">L (low)</option>
                <option value="M" selected>M (medium)</option>
                <option value="Q">Q (quartile)</option>
                <option value="H">H (high)</option>
              </select>
              <div class="form-text">Higher = more resilient, less capacity.</div>
            </div>
            <div class="col-md-4">
              <label for="fg_color" class="form-label">Foreground Color</label>
              <input type="text" class="form-control" id="fg_color" name="fg_color" value="#000000" pattern="^#(?:[0-9a-fA-F]{3}){1,2}$">
              <div class="form-text">Hex color, e.g., #000000.</div>
            </div>
            <div class="col-md-4">
              <label for="bg_color" class="form-label">Background Color</label>
              <input type="text" class="form-control" id="bg_color" name="bg_color" value="#FFFFFF" pattern="^#(?:[0-9a-fA-F]{3}){1,2}$">
              <div class="form-text">Hex color, e.g., #FFFFFF.</div>
            </div>
          </div>

          <div class="row g-3 mt-1">
            <div class="col-md-6">
              <label for="rounded" class="form-label">Border Radius (rounded modules)</label>
              <input type="range" class="form-range" id="rounded" name="rounded" min="0" max="0.5" step="0.05" value="0.2">
              <div class="form-text">0 = square modules, 0.5 = very rounded.</div>
            </div>
            <div class="col-md-6">
              <label for="logo" class="form-label">Logo Overlay (optional)</label>
              <input class="form-control" type="file" id="logo" name="logo" accept=".png,.jpg,.jpeg,.webp" aria-describedby="logoHelp">
              <div id="logoHelp" class="form-text">Max {{ (config.MAX_CONTENT_LENGTH or 5242880) // (1024*1024) }}MB; png/jpg/webp only.</div>
            </div>
          </div>

          <div class="mt-4 d-flex gap-2">
            <button class="btn btn-primary" type="submit">Generate</button>
            <button class="btn btn-outline-secondary" type="reset">Reset</button>
          </div>
        </form>

        <hr class="my-4">
        <p class="small text-muted mb-0">
          Tip: Use error correction H if you overlay a logo, to keep the code scannable.
        </p>
      </div>
    </div>
  </div>
</div>
{% endblock %}
